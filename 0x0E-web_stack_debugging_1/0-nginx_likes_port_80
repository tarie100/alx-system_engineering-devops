#!/usr/bin/env bash
#Nginx must be running, and listening on port 80 of all the serverâ€™s active IPv4 IPs
# Check if Nginx is installed
if ! command -v nginx &> /dev/null; then
    echo "Nginx is not installed. Installing it now..."
    sudo apt update
    sudo apt install nginx -y
else
    echo "Nginx is already installed."
fi

# Stop any conflicting services on port 80
sudo systemctl stop apache2

# Check Nginx configuration file
if ! grep -q 'listen 80' /etc/nginx/sites-available/default; then
    echo "Configuring Nginx to listen on port 80..."

    # Update Nginx configuration
    sudo sed -i 's/listen 80 default_server;/listen 80;/g' /etc/nginx/sites-available/default
    sudo systemctl reload nginx
    echo "Nginx is now listening on port 80."
else
    echo "Nginx is already configured to listen on port 80."
fi
